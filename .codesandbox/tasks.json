{
  "setupTasks": [
    {
      "name": "Create Docker network",
      "command": "docker network create mynetwork || true"
    }
  ],
  "tasks": {
    "start-new-api": {
      "name": "Start New API",
      "command": "/bin/sh -c 'docker rm -f new-api 2>/dev/null || true && docker run --name new-api --network mynetwork -d --restart always -p 3000:3000 -e SQL_DSN=\"$SQL_DSN\" pengzhile/new-api:latest'",
      "runAtStart": true
    },
    "start-cloudflared": {
      "name": "Start Cloudflared",
      "command": "/bin/sh -c 'docker run --rm --name cloudflared --network mynetwork -e TUNNEL_TOKEN=\"$CLOUDFLARE_TOKEN\" cloudflare/cloudflared:latest tunnel --no-autoupdate run --url http://new-api:3000'",
      "runAtStart": true
    }
  }
}
